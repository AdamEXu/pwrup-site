import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.CQ95-tCy.js";function S({post:s}){const l=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),g=r=>r?`${r} min read`:null,o=(r,i=150)=>{const h=r.replace(/[#*`]/g,"").trim();return h.length<=i?h:h.substring(0,i).trim()+"..."};return e.jsx("article",{className:"group cursor-pointer",children:e.jsx("a",{href:`/blog/${s.slug}`,className:"block",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg overflow-hidden hover:border-gray-700 transition-all duration-300 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[s.headerImage&&e.jsxs("div",{className:"relative h-36 overflow-hidden",children:[e.jsx("img",{src:s.headerImage.url,alt:s.headerImage.alt||s.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="published"?"bg-green-900/80 text-green-300 backdrop-blur-sm":"bg-yellow-900/80 text-yellow-300 backdrop-blur-sm"}`,children:s.status})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-3 group-hover:text-blue-400 transition-colors duration-200 line-clamp-2",children:s.title}),e.jsx("p",{className:"text-gray-400 mb-4 line-clamp-3",children:s.description||o(s.content)}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.author.image&&e.jsx("img",{src:s.author.image,alt:s.author.name,className:"w-6 h-6 rounded-full"}),e.jsx("span",{children:s.author.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:l(s.publishedAt||s.createdAt)})]}),s.readingMinutes&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:g(s.readingMinutes)})]})]})}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[s.tags.slice(0,3).map(r=>e.jsxs("span",{className:"px-2 py-1 bg-gray-800 text-gray-400 rounded text-xs hover:bg-gray-700 transition-colors duration-200",children:["#",r]},r)),s.tags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-gray-500 text-xs",children:["+",s.tags.length-3," more"]})]})]})]})})})}function L(){const s=(t,a="")=>typeof window>"u"?a:new URLSearchParams(window.location.search).get(t)??a,[l,g]=n.useState(()=>s("tag")),[o,r]=n.useState(()=>s("month")),[i,h]=n.useState(()=>s("q")),[c,d]=n.useState(()=>parseInt(s("page","1"))||1),[m,k]=n.useState(()=>parseInt(s("limit","10"))||10),[w,x]=n.useState([]),[N,u]=n.useState([]),[y,p]=n.useState([]),[f,j]=n.useState(0),v=Math.max(1,Math.ceil(f/m));return n.useEffect(()=>{fetch("/api/posts/meta").then(t=>t.json()).then(t=>{t.tags&&x(t.tags),t.months&&u(t.months)}).catch(()=>{})},[]),n.useEffect(()=>{const t=new URLSearchParams;l&&t.set("tag",l),o&&t.set("month",o),i&&t.set("q",i),t.set("page",String(c)),t.set("limit",String(m)),fetch(`/api/posts?${t.toString()}`).then(a=>a.json()).then(a=>{p(a.posts||[]),j(a.total||0),a.tags&&x(a.tags),a.months&&u(a.months)}).catch(()=>{p([]),j(0)})},[l,o,i,c,m]),n.useEffect(()=>{const t=new URLSearchParams;l&&t.set("tag",l),o&&t.set("month",o),i&&t.set("q",i),t.set("page",String(c)),t.set("limit",String(m));const a=t.toString(),b=`${window.location.pathname}?${a}`;window.history.replaceState(null,"",b)},[l,o,i,c,m]),e.jsxs("main",{className:"bg-black text-white min-h-screen p-6",children:[e.jsx("div",{id:"push",style:{height:"56px"}}),e.jsxs("div",{className:"blog-page max-w-3xl mx-auto",children:[e.jsxs("div",{className:"filters mt-12 flex flex-row gap-4 flex-wrap justify-center",children:[e.jsx("div",{className:"tags flex flex-wrap gap-4",children:w.map(t=>e.jsx("button",{onClick:()=>{g(t===l?"":t),d(1)},className:`${t===l?"selected":""} px-4 py-2 rounded-full bg-white/10 hover:bg-white/20`,children:t},t))}),e.jsx("div",{className:"month-select mt-4",children:e.jsxs("select",{value:o,onChange:t=>{r(t.target.value),d(1)},className:"bg-white/10 rounded-full px-4 py-2 hover:bg-white/20",children:[e.jsx("option",{value:"",children:"All months"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})}),e.jsx("div",{className:"search-input mt-4",children:e.jsx("input",{type:"text",value:i,placeholder:"Search",onChange:t=>{h(t.target.value),d(1)},className:"bg-white/10 rounded-full px-4 py-2 hover:bg-white/20"})})]}),e.jsx("ul",{className:"posts mt-12 space-y-4",children:y.map((t,a)=>e.jsx(S,{post:t},t.id??a))}),e.jsxs("div",{className:"pagination",children:[e.jsxs("span",{children:["Page ",c," of ",v," (",f," total)"]}),e.jsxs("div",{className:"links",children:[c>1&&e.jsx("button",{onClick:()=>d(c-1),children:"Previous"}),c<v&&e.jsx("button",{onClick:()=>d(c+1),children:"Next"})]})]})]})]})}export{L as default};
